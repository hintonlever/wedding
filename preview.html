<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Section Preview | Wedding</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500&family=Roboto+Flex:wght@200;300;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        .preview-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #333;
            padding: 1rem;
            z-index: 9999;
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }
        .preview-nav a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            background: #555;
            border-radius: 4px;
            font-size: 0.75rem;
            font-family: system-ui, sans-serif;
        }
        .preview-nav a:hover {
            background: #777;
        }
        .preview-nav a.active {
            background: var(--color-accent, #cc5496);
        }
        .preview-container {
            padding-top: 80px;
        }
        .loading {
            text-align: center;
            padding: 4rem;
            font-family: system-ui, sans-serif;
            color: #666;
        }
    </style>
</head>
<body>
    <nav class="preview-nav">
        <a href="?section=hero">Hero</a>
        <a href="?section=rsvp">RSVP</a>
        <a href="?section=accommodation">Accommodation</a>
        <a href="?section=getting-there">Getting There</a>
        <a href="?section=faq">FAQ</a>
        <a href="?section=our-story">Our Story</a>
        <a href="?section=story">Timeline</a>
        <a href="?section=funfacts">Fun Facts</a>
        <a href="?section=game">Game</a>
        <a href="?section=gallery">Gallery</a>
        <a href="?section=dress">Dress Code</a>
        <a href="?section=weather">Weather</a>
        <a href="?section=playlist">Playlist</a>
        <a href="?section=surprise">Surprise</a>
        <a href="?section=confetti">Confetti</a>
        <a href="?section=footer">Footer</a>
        <a href="invite.html" style="background: #2a5;">Full Site</a>
    </nav>

    <div class="page-container preview-container" id="preview">
        <div class="loading">Select a section to preview</div>
    </div>

    <script>
        // Get section from URL
        const params = new URLSearchParams(window.location.search);
        const section = params.get('section');

        // Highlight active nav link
        document.querySelectorAll('.preview-nav a').forEach(link => {
            const linkSection = new URLSearchParams(link.search).get('section');
            if (linkSection === section) {
                link.classList.add('active');
            }
        });

        // Load section content
        if (section) {
            fetch(`sections/${section}.html`)
                .then(response => {
                    if (!response.ok) throw new Error('Section not found');
                    return response.text();
                })
                .then(html => {
                    document.getElementById('preview').innerHTML = html;
                    document.title = `${section} | Section Preview`;

                    // Re-initialize any interactive elements
                    initSectionScripts();
                })
                .catch(err => {
                    document.getElementById('preview').innerHTML = `
                        <div class="loading" style="color: #c00;">
                            Error loading section: ${err.message}
                        </div>
                    `;
                });
        }

        // Initialize scripts for interactive sections
        function initSectionScripts() {
            // FAQ accordion
            document.querySelectorAll('.faq-question').forEach(btn => {
                btn.addEventListener('click', () => {
                    const item = btn.parentElement;
                    const isOpen = item.classList.contains('open');
                    document.querySelectorAll('.faq-item').forEach(i => i.classList.remove('open'));
                    if (!isOpen) item.classList.add('open');
                });
            });

            // Countdown timer
            const weddingDate = new Date('2026-08-29T16:00:00+10:00');
            function updateCountdown() {
                const now = new Date();
                const diff = weddingDate - now;
                if (diff <= 0) return;

                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);

                const daysEl = document.getElementById('days');
                const hoursEl = document.getElementById('hours');
                const minutesEl = document.getElementById('minutes');
                const secondsEl = document.getElementById('seconds');

                if (daysEl) daysEl.textContent = days;
                if (hoursEl) hoursEl.textContent = hours.toString().padStart(2, '0');
                if (minutesEl) minutesEl.textContent = minutes.toString().padStart(2, '0');
                if (secondsEl) secondsEl.textContent = seconds.toString().padStart(2, '0');
            }
            updateCountdown();
            setInterval(updateCountdown, 1000);

            // Fade-in animations
            document.querySelectorAll('.fade-in, .timeline-item').forEach(el => {
                el.classList.add('visible');
            });

            // RSVP conditional fields
            const attendingYes = document.getElementById('attending-yes');
            const attendingNo = document.getElementById('attending-no');
            const conditionalFields = document.getElementById('conditionalFields');

            if (attendingYes && conditionalFields) {
                const updateFields = () => {
                    conditionalFields.classList.toggle('visible', attendingYes.checked);
                };
                attendingYes.addEventListener('change', updateFields);
                attendingNo.addEventListener('change', updateFields);
            }

            // Shake reveal
            const shakeReveal = document.getElementById('shakeReveal');
            if (shakeReveal) {
                shakeReveal.addEventListener('click', () => {
                    shakeReveal.classList.add('revealed');
                });
            }

            // Confetti button
            const confettiBtn = document.getElementById('confettiBtn');
            if (confettiBtn) {
                confettiBtn.addEventListener('click', () => {
                    const area = document.getElementById('confettiArea');
                    for (let i = 0; i < 30; i++) {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.cssText = `
                            position: absolute;
                            width: 10px;
                            height: 10px;
                            background: hsl(${Math.random() * 360}, 80%, 60%);
                            left: ${Math.random() * 100}%;
                            top: 0;
                            animation: fall 2s ease-out forwards;
                        `;
                        area.appendChild(confetti);
                        setTimeout(() => confetti.remove(), 2000);
                    }
                });
            }
        }
    </script>
</body>
</html>
